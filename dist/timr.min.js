/* TimrJS v0.6.0 | (c) 2016 Joe Smith | https://github.com/joesmith100/timrjs/blob/master/LICENSE */
(function(){"use strict";var t=function(e,n){var r=new t.init(e,n);if(n){if(n.store){return a(r)}if(n.store===false){return r}}if(t.store){return a(r)}return r},e=function(t,e){switch(t){case"outputFormat":if(typeof e!=="string"){throw new TypeError("Expected outputFormat to be a string, instead got: "+typeof e)}if(e!=="HH:MM:SS"&&e!=="MM:SS"&&e!=="SS"){throw new Error("Expected outputFormat to be: HH:MM:SS, MM:SS (default) or SS, instead got: "+e)}case"separator":if(typeof e!=="string"){throw new TypeError("Expected separator to be a string, instead got: "+e)}}},n=function(t){var n={outputFormat:"MM:SS",separator:":"};if(t){for(var r in t){e(r,t[r]);n[r]=t[r]}}return n},r=function(t){return t.split(":").reduce(function(t,e,n,r){if(r.length===3){if(n===0){return t+ +e*60*60}if(n===1){return t+ +e*60}}if(r.length===2){if(n===0){return t+ +e*60}}return t+ +e},0)},i=function(t){return t.replace(/\d+/g,function(t){return+t<10?"0"+t:t})},o=function(t){return t.split(":").some(function(t,e,n){return+t<0||+t>(n.length===3&&e===0?23:59)||isNaN(+t)})},s=function(t){if(typeof t==="string"){if(+t<0||isNaN(+t)&&o(t)){throw new Error("Expected time format (HH:MM:SS, MM:SS or SS), instead got: "+t)}}else if(typeof t!=="number"||isNaN(t)){throw new TypeError("Expected time to be a string or number, instead got: "+(typeof t==="number"?t:typeof t))}if(+t>86399){throw new Error("Sorry, we don't support any time over 23:59:59 at the moment.")}return t},u=function(t){t.currentTime-=1;t.emit("ticker",t.formatTime(),t.percentDone(),t.currentTime,t.startTime,t);if(t.currentTime<=0){t.emit("finish");t.stop()}},f=function(t){t.currentTime+=1;t.emit("ticker",t.formatTime(),t.currentTime)},c=[],a=function(t){c.push(t);return t},h=function(){c.forEach(function(t){t.start()})},p=function(){c.forEach(function(t){t.pause()})},m=function(){c.forEach(function(t){t.stop()})},l=function(){c.filter(function(t){t.isRunning()})},d=function(){c.forEach(function(t){t.destroy()});c=[]},y=function(t){c=c.filter(function(e){return e!==t})};t.prototype={constructor:t,on:function(t,e){if(!Array.isArray(this.events[t])){this.events[t]=[]}this.events[t].push(e)},emit:function(t){if(!this.events[t]||this.events[t].length===0){return}var e=[];for(var n=1,r=arguments.length;n<r;n++){e.push(arguments[n])}for(var i=0,o=this.events[t].length;i<o;i++){this.events[t][i].apply(this,e)}},start:function(){if(!this.running){this.running=true;if(this.startTime>0){this.timer=setInterval(u.bind(this,this),1e3)}else{this.timer=setInterval(f.bind(this,this),1e3)}}else{console.warn("Timer already running")}return this},pause:function(){this.clear();return this},stop:function(){this.clear();this.currentTime=this.startTime;return this},clear:function(){clearInterval(this.timer);this.running=false;return this},destroy:function(){this.clear();this.events={};y(this);return this},ticker:function(t){if(typeof t!=="function"){throw new TypeError("Expected ticker to be a function, instead got: "+typeof t)}this.on("ticker",t);return this},finish:function(t){if(typeof t!=="function"){throw new TypeError("Expected finish to be a function, instead got: "+typeof t)}this.on("finish",t);return this},formatTime:function(){var t=this.currentTime,e=t/60,n=this.options.outputFormat,r=this.options.separator;if(e>=1){var o=e/60;e=Math.floor(e);if(o>=1){o=Math.floor(o);return i(o+r+(e-o*60)+r+(t-e*60))}return i((n==="HH:MM:SS"?"0"+"sep":"")+e+r+(t-e*60))}return i((n==="HH:MM:SS"?"0"+r+"0"+r:n==="MM:SS"?"0"+r:"")+t)},percentDone:function(){return 100-Math.round(this.currentTime/this.startTime*100)},getCurrentTime:function(){return this.currentTime},isRunning:function(){return this.running}};t.init=function(t,e){s(t);this.timer=null;this.events={};this.running=false;this.options=n(e);this.startTime=typeof t==="number"?t:r(t);this.currentTime=this.startTime};t.validate=s;t.timeToSeconds=r;t.incorrectFormat=o;t.store=false;t.destroyAll=d;t.isRunning=l;t.startAll=h;t.pauseAll=p;t.stopAll=m;t.init.prototype=t.prototype;if(typeof module!=="undefined"&&module.exports){module.exports=t}else if(typeof define==="function"&&typeof define.amd==="object"&&define.amd){define("Timr",[],function(){return t})}else{window.Timr=t}})();